<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Your Notifications</title>
    
    <meta name="_csrf" th:content="${_csrf.token}"/>
	<meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <!-- Custom stylesheet -->
    <link th:href="@{/css/notification-styles.css}" rel="stylesheet">

</head>


<body>
<div class="container mt-5">
    <h2 class="text-center text-primary mb-4">üîî Your Notifications</h2>

    <!-- inbox -->
    <div class="mb-4 d-flex justify-content-center gap-3 flex-wrap">
        <a th:href="@{/notifications/swap-requests}" class="btn btn-outline-secondary">Swap Requests</a>
    <a th:href="@{/notifications/request-confirmations}" class="btn btn-outline-secondary">Request Confirmations</a>
    <a th:href="@{/notifications/from-reze}" class="btn btn-outline-secondary">From Rezeption</a>
</div>

    <!-- Info if empty -->
    <div th:if="${#lists.isEmpty(notifications)}" class="alert alert-info text-center">
        You have no notifications at the moment.
    </div>

<!-- Notification loop -->
<div th:each="notification : ${notifications}" class="mb-3">
    <div th:class="'alert alert-' + ${notification.type.name().toLowerCase()} + ' d-flex justify-content-between align-items-center notification-box'">
        <div>
            <span class="fw-bold" th:text="${#temporals.format(notification.createdAt, 'dd-MM-yyyy HH:mm')}"></span> ‚Äî
            <span th:text="${notification.message}"></span>
        </div>

        <!-- Buttons for SWAP_REQUEST -->
        <div th:if="${notification.type.name() == 'SWAP_REQUEST'}">
            <button class="btn-accept-swap btn btn-success btn-sm me-2"
                    th:attr="data-id=${notification.swapRequest?.id}"
                    onclick="acceptSwap(this)">Accept</button>

            <button class="btn-reject-swap btn btn-danger btn-sm me-2"
                    th:attr="data-id=${notification.swapRequest?.id}"
                    onclick="rejectSwap(this)">Reject</button>

            <a class="btn btn-outline-info btn-sm"
   					th:if="${notification.swapRequest != null}"
   					th:href="@{'/swap-preview/' + ${notification.swapRequest.id}}">
   					Show in Shiftplan
			</a>


        </div>

        <!-- generic button if not SWAP_REQUEST -->
        <div th:if="${notification.type.name() != 'SWAP_REQUEST'} and ${notification.contextLink != null}">
            <a th:href="@{${notification.contextLink}}" class="btn btn-sm btn-outline-light ms-3">Go</a>
        </div>
    </div>
</div>



    <!-- Back to shift plan -->
    <div class="text-center mt-4">
        <a href="/shiftplan" class="btn btn-primary">‚Üê Back to Shift Plan</a>
    </div>
</div>

<!-- confirmation modal -->
<div class="modal fade" id="confirmModal" tabindex="-1" aria-labelledby="confirmModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-warning">
        <h5 class="modal-title" id="confirmModalLabel">Please Confirm</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="confirmModalMessage">
        <!-- dynamic message here -->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" id="confirmModalYesBtn">Yes</button>
      </div>
    </div>
  </div>
</div>


<!-- Bootstrap JS (optional) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="/js/notifications.js"></script>
</body>
</html>
